machine:
  pre:
    - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test && sudo apt-get update && sudo apt-get install gcc-4.9 g++-4.9
  post:
    - sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.9 50 --slave /usr/bin/g++ g++ /usr/bin/g++-4.9

  environment:
    SAF: “${HOME}/${CIRCLE_PROJECT_REPONAME}/“

checkout:
  override:
    - gcc --version
    - git clone https://github.com/MaryamZaheri/haploclique.git
    - cd haploclique
    - git submodule init && git submodule update

dependencies:
  pre: 
    - wget --no-check-certificate https://github.com/cbg-ethz/ConsensusFixer/releases/download/0.3.1/ConsensusFixer.jar
    - wget --no-check-certificate https://github.com/cbg-ethz/InDelFixer/releases/download/v1.1/InDelFixer.jar
    - sudo apt-get install libncurses5-dev cmake libboost-all-dev git build-essential zlib1g-dev parallel
    - pip install cram
    - cram -h  

  override:
    - mkdir build; cd build; sudo cmake ..; sudo make; sudo make install

test:
  override:
    - cram tests/cram
  post:
    - cp quasispecies.fasta.fasta $CIRCLE_ARTIFACTS

general:
  branches:
    ignore:
      - master   
      - oneclick

